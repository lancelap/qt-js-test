(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(73),i=a.n(o),c=(a(83),a(2)),s=a(3),u=a(5),l=a(4),m=a(6),p=a(74),d=a.n(p),h=a(16);var k=a(77),f=a(26),v=a.n(f),g=a(76),b=a.n(g),y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).clickHandeler=function(e,t){return function(a){a.preventDefault(),t(e)}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.addDragEndListener,n=t.text,r=t.id,o=t.mapY,i=t.ymaps,c=o.getCenter(),s=new i.Placemark(c,{balloonContent:this.props.text},{draggable:!0});this.placemark=s,o.geoObjects.add(s),s.events.add("dragend",function(){var t=s.geometry.getCoordinates();a(e.props.index,{timestamp:r,text:n,coordinates:t})})}},{key:"componentWillUnmount",value:function(){this.placemark.events.remove("dragend"),this.props.mapY.geoObjects.remove(this.placemark)}},{key:"render",value:function(){var e=this.props,t=e.text,a=e.index,n=e.deleteMarker,o=e.isDragging?0:1;return(0,e.connectDragSource)((0,e.connectDropTarget)(r.a.createElement("li",{className:"marker",style:{opacity:o}},r.a.createElement("p",{className:"marker__text"},t),r.a.createElement("button",{className:"marker__button",onClick:this.clickHandeler(a,n)},"X"))))}}]),t}(n.Component),j=b()(Object(h.DragSource)("marker",{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}),Object(h.DropTarget)("marker",{hover:function(e,t,a){var n=t.getItem().index,r=e.index;n!==r&&(e.moveMarker(n,r),t.getItem().index=r)}},function(e){return{connectDropTarget:e.dropTarget()}}))(y),O=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).polyline=null,e.index=null,e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.markers,a=e.ymaps,n=e.mapY;this.polyline=new a.Polyline(t),n.geoObjects.add(this.polyline)}},{key:"componentDidUpdate",value:function(){var e=this.props.markers;this.polyline.geometry.setCoordinates(e)}},{key:"render",value:function(){return null}}]),t}(n.Component),x=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onChangeMarkerTitle=function(t){e.setState({text:t.target.value})},e.onSubmit=function(t){t.preventDefault(),e.props.addMarker(Date.now(),e.state.text,e.props.mapY.getCenter()),e.setState({text:""})},e.state={text:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{className:"marker-form",onSubmit:this.onSubmit},r.a.createElement("input",{className:"marker-form__input",type:"text",value:this.state.text,placeholder:"\u041d\u043e\u0432\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430",onChange:this.onChangeMarkerTitle}))}}]),t}(n.Component),E=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).addMarker=function(t,a,n){var r={timestamp:t,text:a,coordinates:n};e.setState({markers:Object(k.a)(e.state.markers).concat([r])})},e.deleteMarker=function(t){e.setState(v()(e.state,{markers:{$splice:[[t,1]]}}))},e.addDragEndListener=function(t,a){e.setState(v()(e.state,{markers:{$splice:[[t,1,a]]}}))},e.moveMarker=function(t,a){var n=e.state.markers[t];e.setState(v()(e.state,{markers:{$splice:[[t,1],[a,0,n]]}}))},e.state={markers:[]},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.markers,a=this.props,n=a.mapY,o=a.ymaps,i=[],c=[];return t.forEach(function(t,a){c.push(t.coordinates),i.push(r.a.createElement(j,{key:t.timestamp,text:t.text,id:t.timestamp,deleteMarker:e.deleteMarker,index:a,moveMarker:e.moveMarker,addDragEndListener:e.addDragEndListener,ymaps:o,mapY:n}))}),r.a.createElement("div",null,r.a.createElement(x,{addMarker:this.addMarker,mapY:n}),r.a.createElement("ul",{className:"marker-list"},i),r.a.createElement(O,{markers:c,ymaps:o,mapY:n}))}}]),t}(n.Component),D=function(){return r.a.createElement("p",null,"Loading...")},M=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.id,className:"yandex-map",style:{width:"450px",height:"450px"}})}}]),t}(n.Component),C=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={loaded:!1,mapId:"YMapsID",mapY:null,ymaps:null},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initYandexMap",new Promise(function(t,a){var n=document.createElement("script"),r=document.getElementsByTagName("body")[0];e.match(/onload=initYandexMap/)?window.initYandexMap=function(e){return t(e)}:a(new Error("require onload func")),n.src=e,n.onerror=a,r.appendChild(n)})).then(function(e){t.initMap(e)}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){var e=this.state,t=e.loaded,a=e.mapId,n=e.ymaps,o=e.mapY;return r.a.createElement("div",{className:"map"},t?r.a.createElement(E,{ymaps:n,mapY:o}):r.a.createElement(D,null),r.a.createElement(M,{id:a}))}},{key:"initMap",value:function(e){var t=new e.Map(this.state.mapId,{center:[55.87,37.66],zoom:10});this.setState({loaded:!0,mapY:t,ymaps:e})}}]),t}(n.Component),w=Object(h.DragDropContext)(d.a)(C);i.a.render(r.a.createElement(w,null),document.getElementById("root"))},78:function(e,t,a){e.exports=a(209)},83:function(e,t,a){}},[[78,2,1]]]);
//# sourceMappingURL=main.c8748342.chunk.js.map