(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(26),o=n.n(i),c=(n(83),n(1)),s=n(2),u=n(4),l=n(3),p=n(5),d=n(77);var m=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.id,className:"yandex-map",style:{width:"450px",height:"450px"}})}}]),t}(a.Component),h=n(16),g=n(75),f=n.n(g),k=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).clickHandeler=function(e,t){return function(n){n.preventDefault(),t(e)}},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.index,a=e.deleteMarker,i=e.isDragging?0:1;return(0,e.connectDragSource)((0,e.connectDropTarget)(r.a.createElement("li",{className:"marker",style:{opacity:i}},r.a.createElement("p",{className:"marker__text"},t),r.a.createElement("button",{className:"marker__button",onClick:this.clickHandeler(n,a)},"X"))))}}]),t}(a.Component),b={hover:function(e,t,n){var a=t.getItem().index,r=e.index;if(a!==r){var o=Object(i.findDOMNode)(n).getBoundingClientRect(),c=(o.bottom-o.top)/2,s=t.getClientOffset().y-o.top;a<r&&s<c||a>r&&s>c||(e.moveMarker(a,r),t.getItem().index=r)}}},v=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.addDragEndListener,a=t.text,r=t.id,i=(0,t.getMapY)(),o=i.ymaps,c=i.mapY,s=c.getCenter(),u=new o.Placemark(s,{balloonContent:this.props.text},{draggable:!0});this.placemark=u,c.geoObjects.add(u),u.events.add("dragend",function(){var t=u.geometry.getCoordinates();n(e.props.index,{timestamp:r,text:a,coordinates:t})})}},{key:"componentWillUnmount",value:function(){this.placemark.events.remove("dragend"),this.props.getMapY().mapY.geoObjects.remove(this.placemark)}},{key:"render",value:function(){return r.a.createElement(k,this.props)}}]),t}(a.Component),O=f()(Object(h.DragSource)("marker",{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}),Object(h.DropTarget)("marker",b,function(e){return{connectDropTarget:e.dropTarget()}}))(v),j=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).polyline=null,e.index=null,e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.markers,n=(0,e.getMapY)(),a=n.ymaps,r=n.mapY;this.polyline=new a.Polyline(t),r.geoObjects.add(this.polyline)}},{key:"componentDidUpdate",value:function(){var e=this.props.markers;this.polyline.geometry.setCoordinates(e)}},{key:"render",value:function(){return null}}]),t}(a.Component),y=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.deleteMarker,n=e.markers,a=e.addDragEndListener,i=e.removeDragEndListener,o=e.moveMarker,c=e.getMapY,s=n.map(function(e,n){return r.a.createElement(O,{key:e.timestamp,text:e.text,id:e.timestamp,deleteMarker:t,index:n,moveMarker:o,addDragEndListener:a,removeDragEndListener:i,getMapY:c})}),u=n.map(function(e){return e.coordinates});return r.a.createElement("ul",{className:"marker-list"},s,r.a.createElement(j,{markers:u,getMapY:c}))}}]),t}(a.Component),M=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onChangeMarkerTitle=function(t){e.setState({text:t.target.value})},e.onSubmit=function(t){t.preventDefault();var n=e.props.getMapY().mapY;e.props.addMarker(Date.now(),e.state.text,n.getCenter()),e.setState({text:""})},e.state={text:""},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{className:"marker-form",onSubmit:this.onSubmit},r.a.createElement("input",{className:"marker-form__input",type:"text",value:this.state.text,placeholder:"\u041d\u043e\u0432\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430",onChange:this.onChangeMarkerTitle}))}}]),t}(a.Component),x=n(27),D=n.n(x),E=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).addMarker=function(t,n,a){var r={timestamp:t,text:n,coordinates:a};e.setState({markers:Object(d.a)(e.state.markers).concat([r])})},e.deleteMarker=function(t){e.setState(D()(e.state,{markers:{$splice:[[t,1]]}}))},e.addDragEndListener=function(t,n){e.setState(D()(e.state,{markers:{$splice:[[t,1,n]]}}))},e.moveMarker=function(t,n){var a=e.state.markers[t];e.setState(D()(e.state,{markers:{$splice:[[t,1],[n,0,a]]}}))},e.getMapY=null,e.state={loaded:!1,mapId:"YMapsID",markers:[]},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initYandexMap",new Promise(function(t,n){var a=document.createElement("script"),r=document.getElementsByTagName("body")[0];e.match(/onload=initYandexMap/)?window.initYandexMap=function(e){return t(e)}:n(new Error("require onload func")),a.src=e,a.onerror=n,r.appendChild(a)})).then(function(e){t.initMap(e)}).catch(function(e){return console.error(e)})}},{key:"initMap",value:function(e){var t=new e.Map(this.state.mapId,{center:[55.87,37.66],zoom:10});this.getMapY=function(){return{ymaps:e,mapY:t}},this.setState({loaded:!0})}},{key:"render",value:function(){var e=this.state,t=e.mapId,n=e.loaded,a=e.markers;return r.a.createElement("div",{className:"map"},n?r.a.createElement("div",null,r.a.createElement(M,{addMarker:this.addMarker,getMapY:this.getMapY}),r.a.createElement(y,{getMapY:this.getMapY,deleteMarker:this.deleteMarker,moveMarker:this.moveMarker,addDragEndListener:this.addDragEndListener,removeDragEndListener:this.removeDragEndListener,markers:a})):null,r.a.createElement(m,{id:t}))}}]),t}(a.Component),C=n(76),Y=n.n(C),w=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(E,null)}}]),t}(a.Component),S=Object(h.DragDropContext)(Y.a)(w);o.a.render(r.a.createElement(S,null),document.getElementById("root"))},78:function(e,t,n){e.exports=n(209)},83:function(e,t,n){}},[[78,2,1]]]);
//# sourceMappingURL=main.dd60d346.chunk.js.map