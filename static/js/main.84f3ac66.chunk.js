(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(73),i=n.n(o),c=(n(83),n(2)),s=n(3),u=n(5),l=n(4),m=n(6),p=n(74),d=n.n(p),h=n(16);var f=n(77),k=n(26),b=n.n(k),v=n(76),g=n.n(v),y=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).clickHandeler=function(e,t){return function(n){n.preventDefault(),t(e)}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.addDragEndListener,a=t.text,r=t.id,o=t.mapY,i=t.ymaps,c=o.getCenter(),s=new i.Placemark(c,{balloonContent:this.props.text},{draggable:!0});this.placemark=s,o.geoObjects.add(s),s.events.add("dragend",function(){var t=s.geometry.getCoordinates();n(e.props.index,{timestamp:r,text:a,coordinates:t})})}},{key:"componentWillUnmount",value:function(){this.placemark.events.remove("dragend"),this.props.mapY.geoObjects.remove(this.placemark)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.index,a=e.deleteMarker,o=e.isDragging?0:1;return(0,e.connectDragSource)((0,e.connectDropTarget)(r.a.createElement("li",{className:"marker",style:{opacity:o}},r.a.createElement("p",{className:"marker__text"},t),r.a.createElement("button",{className:"marker__button",onClick:this.clickHandeler(n,a)},"X"))))}}]),t}(a.Component),j=g()(Object(h.DragSource)("marker",{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}),Object(h.DropTarget)("marker",{hover:function(e,t,n){var a=t.getItem().index,r=e.index;a!==r&&(e.moveMarker(a,r),t.getItem().index=r)}},function(e){return{connectDropTarget:e.dropTarget()}}))(y),O=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).polyline=null,e.index=null,e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.markers,n=e.ymaps,a=e.mapY;this.polyline=new n.Polyline(t),a.geoObjects.add(this.polyline)}},{key:"componentDidUpdate",value:function(){var e=this.props.markers;this.polyline.geometry.setCoordinates(e)}},{key:"render",value:function(){return null}}]),t}(a.Component),x=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onChangeMarkerTitle=function(t){e.setState({text:t.target.value})},e.onSubmit=function(t){t.preventDefault(),e.props.addMarker(Date.now(),e.state.text,e.props.mapY.getCenter()),e.setState({text:""})},e.state={text:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{className:"marker-form",onSubmit:this.onSubmit},r.a.createElement("input",{className:"marker-form__input",type:"text",value:this.state.text,placeholder:"\u041d\u043e\u0432\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430",onChange:this.onChangeMarkerTitle}))}}]),t}(a.Component),E=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).addMarker=function(t,n,a){var r={timestamp:t,text:n,coordinates:a};e.setState({markers:Object(f.a)(e.state.markers).concat([r])})},e.deleteMarker=function(t){e.setState(b()(e.state,{markers:{$splice:[[t,1]]}}))},e.addDragEndListener=function(t,n){e.setState(b()(e.state,{markers:{$splice:[[t,1,n]]}}))},e.moveMarker=function(t,n){var a=e.state.markers[t];e.setState(b()(e.state,{markers:{$splice:[[t,1],[n,0,a]]}}))},e.state={markers:[]},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.markers,n=this.props,a=n.mapY,o=n.ymaps,i=t.map(function(t,n){return r.a.createElement(j,{key:t.timestamp,text:t.text,id:t.timestamp,deleteMarker:e.deleteMarker,index:n,moveMarker:e.moveMarker,addDragEndListener:e.addDragEndListener,ymaps:o,mapY:a})}),c=t.map(function(e){return e.coordinates});return r.a.createElement("div",null,r.a.createElement(x,{addMarker:this.addMarker,mapY:a}),r.a.createElement("ul",{className:"marker-list"},i),r.a.createElement(O,{markers:c,ymaps:o,mapY:a}))}}]),t}(a.Component),D=function(){return r.a.createElement("p",null,"Loading...")},M=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.id,className:"yandex-map",style:{width:"450px",height:"450px"}})}}]),t}(a.Component),C=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={loaded:!1,mapId:"YMapsID",mapY:null,ymaps:null},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initYandexMap",new Promise(function(t,n){var a=document.createElement("script"),r=document.getElementsByTagName("body")[0];e.match(/onload=initYandexMap/)?window.initYandexMap=function(e){return t(e)}:n(new Error("require onload func")),a.src=e,a.onerror=n,r.appendChild(a)})).then(function(e){t.initMap(e)}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){var e=this.state,t=e.loaded,n=e.mapId,a=e.ymaps,o=e.mapY;return r.a.createElement("div",{className:"map"},t?r.a.createElement(E,{ymaps:a,mapY:o}):r.a.createElement(D,null),r.a.createElement(M,{id:n}))}},{key:"initMap",value:function(e){var t=new e.Map(this.state.mapId,{center:[55.87,37.66],zoom:10});this.setState({loaded:!0,mapY:t,ymaps:e})}}]),t}(a.Component),w=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(C,null)}}]),t}(a.Component),Y=Object(h.DragDropContext)(d.a)(w);i.a.render(r.a.createElement(Y,null),document.getElementById("root"))},78:function(e,t,n){e.exports=n(209)},83:function(e,t,n){}},[[78,2,1]]]);
//# sourceMappingURL=main.84f3ac66.chunk.js.map